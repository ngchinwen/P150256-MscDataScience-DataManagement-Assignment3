{"paragraphs":[{"text":"%pyspark\ndf = spark.read.format(\"org.apache.spark.sql.cassandra\").options(table=\"users\",keyspace=\"movielens\").load()\ndf.show()","user":"anonymous","dateUpdated":"2025-06-21T08:27:09+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+---+------+-------------+-----+\n|user_id|age|gender|   occupation|  zip|\n+-------+---+------+-------------+-----+\n|    707| 56|     F|    librarian|19146|\n|     79| 39|     F|administrator|03755|\n|    210| 39|     M|     engineer|03060|\n|    505| 27|     F|        other|20657|\n|     16| 21|     M|entertainment|10309|\n|    942| 48|     F|    librarian|78209|\n|    402| 30|     M|     engineer|95129|\n|     63| 31|     M|    marketing|75240|\n|    768| 29|     M|administrator|12866|\n|    725| 21|     M|      student|91711|\n|    642| 18|     F|      student|95521|\n|    835| 44|     F|    executive|11577|\n|    864| 27|     M|   programmer|63021|\n|    774| 30|     M|      student|80027|\n|    508| 27|     M|    marketing|19382|\n|    490| 29|     F|       artist|V5A2B|\n|    852| 46|     M|administrator|94086|\n|    253| 26|     F|    librarian|22903|\n|    723| 26|     M|    executive|94403|\n|    650| 42|     M|     engineer|83814|\n+-------+---+------+-------------+-----+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1750493899972_1907965551","id":"20250621-081819_353265326","dateCreated":"2025-06-21T08:18:19+0000","dateStarted":"2025-06-21T08:27:09+0000","dateFinished":"2025-06-21T08:27:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3611"},{"text":"\n%md\n\nI didn't have the table for ratings so I had to add it via this cqlsh. Also I mislablled it. It should be 'ratings' actually but it's named 'movies' for now. lmao\n```\nDROP TABLE IF EXISTS movielens.movies;\n\n\nCREATE KEYSPACE IF NOT EXISTS movielens\nWITH replication = {'class': 'SimpleStrategy', 'replication_factor': 1};\n\n\nCREATE TABLE IF NOT EXISTS movielens.movies (\n    user_id int,\n    movie_id int,\n    rating float,\n    PRIMARY KEY (movie_id, user_id)\n);\n```\n\nFor actual movies info, I named the table 'info'.\n```\nDROP TABLE IF EXISTS movielens.titles;\nCREATE KEYSPACE IF NOT EXISTS movielens\nWITH replication = {'class': 'SimpleStrategy', 'replication_factor': 1};\nCREATE TABLE IF NOT EXISTS movielens.titles (\n    movie_id int,\n    rating float,\n    PRIMARY KEY (movie_id, user_id)\n);\n```\n","user":"anonymous","dateUpdated":"2025-06-21T09:23:55+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":false,"tableHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1750497320613_-486082265","id":"20250621-091520_1636486080","dateCreated":"2025-06-21T09:15:20+0000","dateStarted":"2025-06-21T09:18:00+0000","dateFinished":"2025-06-21T09:18:00+0000","status":"ERROR","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3612"},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1750500664564_1534995485","id":"20250621-101104_2008990782","dateCreated":"2025-06-21T10:11:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4789","text":"%md \nIdentifying average movies, done without the title yet","dateUpdated":"2025-06-21T10:11:50+0000","dateFinished":"2025-06-21T10:11:51+0000","dateStarted":"2025-06-21T10:11:50+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Identifying average movies, done without the title yet</p>\n"}]}},{"text":"%pyspark\nfrom pyspark.sql import SparkSession\nfrom pyspark.sql import Row\nfrom pyspark.sql.functions import avg\n\ndef parseRating(line):\n    fields = line.split(\"\\t\")\n    return Row(user_id=int(fields[0]), movie_id=int(fields[1]), rating=float(fields[2]))\n\n\nspark = SparkSession.builder \\\n        .appName(\"CassandraIntegration\") \\\n        .config(\"spark.cassandra.connection.host\", \"127.0.0.1\") \\\n        .getOrCreate()\n\nlines = spark.sparkContext.textFile(\"hdfs:///user/maria_dev/ml-100k/u.data\")\nratings = lines.map(parseRating)\nratingsDF = spark.createDataFrame(ratings)\nratingsDF.write \\\n    .format(\"org.apache.spark.sql.cassandra\") \\\n    .mode(\"append\") \\\n    .option(\"table\", \"movies\") \\\n    .option(\"keyspace\", \"movielens\") \\\n    .save()\n\nreadMovies = spark.read \\\n    .format(\"org.apache.spark.sql.cassandra\") \\\n    .option(\"table\", \"movies\") \\\n    .option(\"keyspace\", \"movielens\") \\\n    .load()\n\nreadMovies.createOrReplaceTempView(\"movies\")\n\nsqlDF = spark.sql(\"\"\"\n    SELECT movie_id, AVG(rating) AS avg_rating\n    FROM movies\n    GROUP BY movie_id\n    ORDER BY avg_rating DESC\n    LIMIT 10\n\"\"\")\nsqlDF.show()","user":"anonymous","dateUpdated":"2025-06-21T09:08:09+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+----------+\n|movie_id|avg_rating|\n+--------+----------+\n|    1599|       5.0|\n|    1293|       5.0|\n|    1653|       5.0|\n|    1201|       5.0|\n|    1189|       5.0|\n|    1467|       5.0|\n|    1122|       5.0|\n|    1500|       5.0|\n|    1536|       5.0|\n|     814|       5.0|\n+--------+----------+\n\n"}]},"apps":[],"jobName":"paragraph_1750494513339_1042939465","id":"20250621-082833_136851534","dateCreated":"2025-06-21T08:28:33+0000","dateStarted":"2025-06-21T09:08:09+0000","dateFinished":"2025-06-21T09:11:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3613"},{"text":"%md\nI actually sort out the 'movies' (supposed to be ratings) and the 'titles' tables.","user":"anonymous","dateUpdated":"2025-06-21T10:12:32+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1750500721183_18977549","id":"20250621-101201_323932428","dateCreated":"2025-06-21T10:12:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4899","dateFinished":"2025-06-21T10:12:32+0000","dateStarted":"2025-06-21T10:12:32+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>I actually sort out the 'movies' (supposed to be ratings) and the 'titles' tables.</p>\n"}]}},{"text":"%pyspark\nfrom pyspark.sql import SparkSession\nfrom pyspark.sql import Row\nfrom pyspark.sql.functions import avg\n\ndef parseRating(line):\n    fields = line.split(\"\\t\")\n    return Row(user_id=int(fields[0]), movie_id=int(fields[1]), rating=float(fields[2]))\n\ndef parseItem(line):\n    fields = line.split(\"|\")\n    return Row(movie_id=int(fields[0]), title=fields[1])\n\nspark = SparkSession.builder \\\n    .appName(\"CassandraIntegration\") \\\n    .config(\"spark.cassandra.connection.host\", \"127.0.0.1\") \\\n    .getOrCreate()\n\nratings_lines = spark.sparkContext.textFile(\"hdfs:///user/maria_dev/ml-100k/u.data\")\nratings = ratings_lines.map(parseRating)\nratingsDF = spark.createDataFrame(ratings)\n\nratingsDF.write \\\n    .format(\"org.apache.spark.sql.cassandra\") \\\n    .mode(\"append\") \\\n    .option(\"table\", \"movies\") \\\n    .option(\"keyspace\", \"movielens\") \\\n    .save()\n\nitems_lines = spark.sparkContext.textFile(\"hdfs:///user/maria_dev/ml-100k/u.item\")\nitems = items_lines.map(parseItem)\nitemsDF = spark.createDataFrame(items)\n\nitemsDF.write \\\n    .format(\"org.apache.spark.sql.cassandra\") \\\n    .mode(\"append\") \\\n    .option(\"table\", \"titles\") \\\n    .option(\"keyspace\", \"movielens\") \\\n    .save()\n","user":"anonymous","dateUpdated":"2025-06-21T09:33:00+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1750497929863_1363695212","id":"20250621-092529_323414961","dateCreated":"2025-06-21T09:25:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3614","dateFinished":"2025-06-21T09:32:48+0000","dateStarted":"2025-06-21T09:32:07+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%md\r\nOrdered by top average rating, following by the number of reviews it got, the highest average rated movie is Star Kid, Prefontaine, Saint of Fort Washington and Santa with Muscles. These are all somewhat niche movies. So most likely the high average rating is influenced by the extremely low number of reviews, making it easy to get a perfect score.","user":"anonymous","dateUpdated":"2025-06-21T10:15:53+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1750500763543_1196370480","id":"20250621-101243_636084934","dateCreated":"2025-06-21T10:12:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4988","dateFinished":"2025-06-21T10:15:53+0000","dateStarted":"2025-06-21T10:15:53+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Ordered by top average rating, following by the number of reviews it got, the highest average rated movie is Star Kid, Prefontaine, Saint of Fort Washington and Santa with Muscles. These are all somewhat niche movies. So most likely the high average rating is influenced by the extremely low number of reviews, making it easy to get a perfect score.</p>\n"}]}},{"text":"%pyspark\nratingsDF = spark.read \\\n    .format(\"org.apache.spark.sql.cassandra\") \\\n    .option(\"table\", \"movies\") \\\n    .option(\"keyspace\", \"movielens\") \\\n    .load()\n\ntitlesDF = spark.read \\\n    .format(\"org.apache.spark.sql.cassandra\") \\\n    .option(\"table\", \"titles\") \\\n    .option(\"keyspace\", \"movielens\") \\\n    .load()\n\nratingsDF.createOrReplaceTempView(\"movies\")\ntitlesDF.createOrReplaceTempView(\"titles\")\n\nsqlDF = spark.sql(\"\"\"\n    SELECT \n        mt.title, \n        AVG(m.rating) AS avg_rating, \n        COUNT(*) AS rating_count\n    FROM movies m\n    JOIN titles mt ON m.movie_id = mt.movie_id\n    GROUP BY mt.title\n    ORDER BY avg_rating DESC, rating_count DESC\n    LIMIT 10\n\"\"\")\n\nsqlDF.show(truncate=False)","user":"anonymous","dateUpdated":"2025-06-21T10:09:26+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1750498382328_1393545283","id":"20250621-093302_478755667","dateCreated":"2025-06-21T09:33:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4110","dateFinished":"2025-06-21T10:09:40+0000","dateStarted":"2025-06-21T10:09:26+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------------------------------------+----------+------------+\n|title                                            |avg_rating|rating_count|\n+-------------------------------------------------+----------+------------+\n|Star Kid (1997)                                  |5.0       |3           |\n|Prefontaine (1997)                               |5.0       |3           |\n|Saint of Fort Washington, The (1993)             |5.0       |2           |\n|Santa with Muscles (1996)                        |5.0       |2           |\n|Aiqing wansui (1994)                             |5.0       |1           |\n|Someone Else's America (1995)                    |5.0       |1           |\n|Marlene Dietrich: Shadow and Light (1996)        |5.0       |1           |\n|Great Day in Harlem, A (1994)                    |5.0       |1           |\n|Entertaining Angels: The Dorothy Day Story (1996)|5.0       |1           |\n|They Made Me a Criminal (1939)                   |5.0       |1           |\n+-------------------------------------------------+----------+------------+\n\n"}]}},{"text":"%pyspark\r\nfrom pyspark.sql import SparkSession\r\nfrom pyspark.sql import Row\r\nfrom pyspark.sql import functions\r\n\r\ndef parseInput(line):\r\n    fields = line.split('|')\r\n    return Row(user_id = int(fields[0]), age = int(fields[1]), gender = fields[2], occupation = fields[3], zip=fields[4])\r\n\r\nspark = SparkSession.builder.appName(\"CassandraIntegration\").config(\"spark.cassandra.connection.host\",\"127.0.0.1\").getOrCreate()\r\nlines = spark.sparkContext.textFile(\"hdfs:///user/maria_dev/ml-100k/u.user\")\r\nusers = lines.map(parseInput)\r\nusersDataset = spark.createDataFrame(users)\r\nusersDataset.write \\\r\n    .format(\"org.apache.spark.sql.cassandra\") \\\r\n    .mode(\"append\") \\\r\n    .option(\"table\", \"users\") \\\r\n    .option(\"keyspace\", \"movielens\") \\\r\n    .save()\r\n\r\nreadUsers = spark.read \\\r\n    .format(\"org.apache.spark.sql.cassandra\") \\\r\n    .option(\"table\", \"users\") \\\r\n    .option(\"keyspace\", \"movielens\") \\\r\n    .load()\r\n\r\nreadUsers.createOrReplaceTempView(\"users\")\r\nsqlDF = spark.sql(\"SELECT * FROM users WHERE age < 20\" LIMIT 10)\r\nsqlDF.show()","user":"anonymous","dateUpdated":"2025-06-21T08:43:11+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+---+------+-------------+-----+\n|user_id|age|gender|   occupation|  zip|\n+-------+---+------+-------------+-----+\n|    642| 18|     F|      student|95521|\n|    588| 18|     F|      student|93063|\n|     30|  7|     M|      student|55436|\n|    528| 18|     M|      student|55104|\n|    674| 13|     F|      student|55337|\n|    375| 17|     M|entertainment|37777|\n|    851| 18|     M|        other|29646|\n|    859| 18|     F|        other|06492|\n|    813| 14|     F|      student|02136|\n|     52| 18|     F|      student|55105|\n|    397| 17|     M|      student|27514|\n|    257| 17|     M|      student|77005|\n|    221| 19|     M|      student|20685|\n|    368| 18|     M|      student|92113|\n|    507| 18|     F|       writer|28450|\n|    624| 19|     M|      student|30067|\n|    592| 18|     M|      student|97520|\n|    434| 16|     F|      student|49705|\n|    618| 15|     F|      student|44212|\n|    471| 10|     M|      student|77459|\n+-------+---+------+-------------+-----+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1750493549382_-608577958","id":"20250621-081229_2100452687","dateCreated":"2025-06-21T08:12:29+0000","dateStarted":"2025-06-21T08:42:17+0000","dateFinished":"2025-06-21T08:42:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3615"},{"text":"%pyspark\nsqlDF = spark.sql(\"SELECT * FROM users WHERE occupation = 'scientist' AND age BETWEEN 30 AND 40 LIMIT 10\")\nsqlDF.show()","user":"anonymous","dateUpdated":"2025-06-21T08:44:05+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+---+------+----------+-----+\n|user_id|age|gender|occupation|  zip|\n+-------+---+------+----------+-----+\n|    730| 31|     F| scientist|32114|\n|    272| 33|     M| scientist|53706|\n|    430| 38|     M| scientist|98199|\n|    643| 39|     M| scientist|55122|\n|    543| 33|     M| scientist|95123|\n|    554| 32|     M| scientist|62901|\n|     40| 38|     M| scientist|27514|\n|     71| 39|     M| scientist|98034|\n|    874| 36|     M| scientist|37076|\n|    538| 31|     M| scientist|21010|\n|     74| 39|     M| scientist|T8H1N|\n|    183| 33|     M| scientist|27708|\n|    107| 39|     M| scientist|60466|\n|    918| 40|     M| scientist|70116|\n|    337| 37|     M| scientist|10522|\n|    309| 40|     M| scientist|70802|\n+-------+---+------+----------+-----+\n\n"}]},"apps":[],"jobName":"paragraph_1750494783193_-1281345609","id":"20250621-083303_2023780750","dateCreated":"2025-06-21T08:33:03+0000","dateStarted":"2025-06-21T08:43:52+0000","dateFinished":"2025-06-21T08:43:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3616"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2025-06-21T10:16:05+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1750500965735_2144451422","id":"20250621-101605_756906797","dateCreated":"2025-06-21T10:16:05+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5071"},{"text":"%pyspark\nfrom pyspark.sql import SparkSession\n\nspark = SparkSession.builder \\\n    .appName(\"topmovies\") \\\n    .config(\"spark.cassandra.connection.host\", \"127.0.0.1\") \\\n    .getOrCreate()\nsqlDF = spark.sql(\"\"\"\n    SELECT m.user_id, mt.title, m.rating\n    FROM movies m\n    JOIN (\n        SELECT user_id\n        FROM movies\n        GROUP BY user_id\n        HAVING COUNT(*) >= 50\n    ) topusers ON m.user_id = topusers.user_id\n    JOIN titles mt ON m.movie_id = mt.movie_id\n    WHERE m.rating >= 4.5\n    ORDER BY m.user_id, m.rating DESC\n\"\"\")\n\nsqlDF.show(truncate=False)","user":"anonymous","dateUpdated":"2025-06-21T09:47:10+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1750498944217_-207951494","id":"20250621-094224_2131391415","dateCreated":"2025-06-21T09:42:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4223","dateFinished":"2025-06-21T09:54:29+0000","dateStarted":"2025-06-21T09:47:10+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-----------------------------------------------+------+\n|user_id|title                                          |rating|\n+-------+-----------------------------------------------+------+\n|1      |Remains of the Day, The (1993)                 |5.0   |\n|1      |Toy Story (1995)                               |5.0   |\n|1      |Mighty Aphrodite (1995)                        |5.0   |\n|1      |Sleeper (1973)                                 |5.0   |\n|1      |Good, The Bad and The Ugly, The (1966)         |5.0   |\n|1      |Ridicule (1996)                                |5.0   |\n|1      |Nightmare Before Christmas, The (1993)         |5.0   |\n|1      |Welcome to the Dollhouse (1995)                |5.0   |\n|1      |Truth About Cats & Dogs, The (1996)            |5.0   |\n|1      |Henry V (1989)                                 |5.0   |\n|1      |Big Night (1996)                               |5.0   |\n|1      |Pillow Book, The (1995)                        |5.0   |\n|1      |Haunted World of Edward D. Wood Jr., The (1995)|5.0   |\n|1      |Usual Suspects, The (1995)                     |5.0   |\n|1      |Sling Blade (1996)                             |5.0   |\n|1      |Kids in the Hall: Brain Candy (1996)           |5.0   |\n|1      |Dolores Claiborne (1994)                       |5.0   |\n|1      |Chasing Amy (1997)                             |5.0   |\n|1      |Hudsucker Proxy, The (1994)                    |5.0   |\n|1      |Alien (1979)                                   |5.0   |\n+-------+-----------------------------------------------+------+\nonly showing top 20 rows\n\n"}]}},{"text":"%pyspark\nfrom pyspark.sql.functions import collect_list, concat_ws\n\n# Starting from the existing SQL DataFrame\nsqlDF = spark.sql(\"\"\"\n    SELECT m.user_id, mt.title, m.rating\n    FROM movies m\n    JOIN (\n        SELECT user_id\n        FROM movies\n        GROUP BY user_id\n        HAVING COUNT(*) >= 50\n    ) topusers ON m.user_id = topusers.user_id\n    JOIN titles mt ON m.movie_id = mt.movie_id\n    WHERE m.rating >= 4.5\n\"\"\")\n\n# Group by user_id, aggregate titles as comma-separated string\nresultDF = sqlDF.groupBy(\"user_id\") \\\n    .agg(concat_ws(\", \", collect_list(\"title\")).alias(\"favorite_titles\"))\n\nresultDF.show(truncate=False)","user":"anonymous","dateUpdated":"2025-06-21T10:18:48+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1750501124408_-950790538","id":"20250621-101844_312490191","dateCreated":"2025-06-21T10:18:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5130","dateFinished":"2025-06-21T10:19:04+0000","dateStarted":"2025-06-21T10:18:48+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n|user_id|favorite_titles                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |\n+-------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n|148    |Gone with the Wind (1939), Hunchback of Notre Dame, The (1996), Being There (1979), This Is Spinal Tap (1984), James and the Giant Peach (1996), Dr. Strangelove or: How I Learned to Stop Worrying and Love the Bomb (1963), Monty Python and the Holy Grail (1974), Wrong Trousers, The (1993), Fantasia (1940), Streetcar Named Desire, A (1951), Wallace & Gromit: The Best of Aardman Animation (1996), Princess Bride, The (1987), Twelve Monkeys (1995), Sting, The (1973), Forrest Gump (1994), My Left Foot (1989), Star Wars (1977), Return of the Jedi (1983), Four Weddings and a Funeral (1994), Close Shave, A (1995), Pink Floyd - The Wall (1982), Pulp Fiction (1994), Walkabout (1971), Lion King, The (1994), Cold Comfort Farm (1995), 2001: A Space Odyssey (1968), My Life as a Dog (Mitt liv som hund) (1985), One Flew Over the Cuckoo's Nest (1975), Raiders of the Lost Ark (1981), Empire Strikes Back, The (1980), Blade Runner (1982)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |\n|496    |Gone with the Wind (1939), Immortal Beloved (1994), Henry V (1989), Prophecy, The (1995), Interview with the Vampire (1994), Amadeus (1984), Mallrats (1995), Bram Stoker's Dracula (1992), Princess Bride, The (1987), Strange Days (1995), Searching for Bobby Fischer (1993), Restoration (1995), Kama Sutra: A Tale of Love (1996), Richard III (1995), Star Wars (1977), Return of the Jedi (1983), Farewell My Concubine (1993), Pulp Fiction (1994), Mary Shelley's Frankenstein (1994), Clerks (1994), Rosencrantz and Guildenstern Are Dead (1990), Empire Strikes Back, The (1980), Blade Runner (1982)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |\n|833    |Alien (1979), Die xue shuang xiong (Killer, The) (1989), Raging Bull (1980), Starship Troopers (1997), Usual Suspects, The (1995), This Is Spinal Tap (1984), Jackie Brown (1997), Chinatown (1974), Ed Wood (1994), Good, The Bad and The Ugly, The (1966), Bride of Frankenstein (1935), Psycho (1960), GoodFellas (1990), Dr. Strangelove or: How I Learned to Stop Worrying and Love the Bomb (1963), Monty Python and the Holy Grail (1974), Boogie Nights (1997), Raise the Red Lantern (1991), Once Upon a Time in the West (1969), Terminator 2: Judgment Day (1991), Monty Python's Life of Brian (1979), Carrie (1976), Clockwork Orange, A (1971), Godfather, The (1972), Romper Stomper (1992), Taxi Driver (1976), Wild Bunch, The (1969), Glengarry Glen Ross (1992), Terminator, The (1984), Crumb (1994), Unforgiven (1992), Sunset Blvd. (1950), Face/Off (1997), Seven (Se7en) (1995), People vs. Larry Flynt, The (1996), Living in Oblivion (1995), Switchblade Sisters (1975), Night of the Living Dead (1968), Apocalypse Now (1979), Citizen Kane (1941), Godfather: Part II, The (1974), Blade Runner (1982)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |\n|463    |Pillow Book, The (1995), Eve's Bayou (1997), Angels and Insects (1995), Emma (1996), Contact (1997), Antonia's Line (1995), Full Monty, The (1997), Godfather, The (1972), In & Out (1997), Breaking the Waves (1996), Cold Comfort Farm (1995), Lone Star (1996), L.A. Confidential (1997), Sense and Sensibility (1995)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |\n|897    |It's a Wonderful Life (1946), Dragonheart (1996), Christmas Carol, A (1938), Cape Fear (1962), Eraser (1996), M*A*S*H (1970), Indiana Jones and the Last Crusade (1989), Alien (1979), Dumbo (1941), Braveheart (1995), Young Guns (1988), Good, The Bad and The Ugly, The (1966), Old Yeller (1957), Wizard of Oz, The (1939), Psycho (1960), Rear Window (1954), Toy Story (1995), Screamers (1995), Unforgettable (1996), Day the Earth Stood Still, The (1951), Ghost (1990), Once Upon a Time in the West (1969), Terminator 2: Judgment Day (1991), Arsenic and Old Lace (1944), Cool Hand Luke (1967), Godfather, The (1972), Father of the Bride (1950), E.T. the Extra-Terrestrial (1982), African Queen, The (1951), Speed (1994), Top Gun (1986), Conan the Barbarian (1981), Aliens (1986), Mr. Smith Goes to Washington (1939), Birds, The (1963), Sting, The (1973), Jungle Book, The (1994), Craft, The (1996), Forrest Gump (1994), Dances with Wolves (1990), Jaws (1975), Star Wars (1977), Jurassic Park (1993), Scream (1996), Independence Day (ID4) (1996), Sound of Music, The (1965), Nutty Professor, The (1996), Ben-Hur (1959), Pink Floyd - The Wall (1982), Michael (1996), Terminator, The (1984), Silence of the Lambs, The (1991), Willy Wonka and the Chocolate Factory (1971), Shining, The (1980), Miracle on 34th Street (1994), Full Metal Jacket (1987), Desperado (1995), Crow, The (1994), Lion King, The (1994), Fugitive, The (1993), Evil Dead II (1987), Twister (1996), Snow White and the Seven Dwarfs (1937), Mission: Impossible (1996), Blues Brothers, The (1980), Night of the Living Dead (1968), Raiders of the Lost Ark (1981), Apocalypse Now (1979), Deer Hunter, The (1978), Godfather: Part II, The (1974), Young Frankenstein (1974)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |\n|392    |Third Man, The (1949), Mother (1996), This Is Spinal Tap (1984), It Happened One Night (1934), Everyone Says I Love You (1996), Chasing Amy (1997), 12 Angry Men (1957), Boogie Nights (1997), Adventures of Robin Hood, The (1938), Seventh Seal, The (Sjunde inseglet, Det) (1957), Amadeus (1984), Chasing Amy (1997), Men in Black (1997), Lawrence of Arabia (1962), Full Monty, The (1997), 39 Steps, The (1935), Jean de Florette (1986), Clockwork Orange, A (1971), As Good As It Gets (1997), Godfather, The (1972), Graduate, The (1967), When We Were Kings (1996), Babe (1995), Taxi Driver (1976), Manon of the Spring (Manon des sources) (1986), Waiting for Guffman (1996), Star Wars (1977), Return of the Jedi (1983), Evita (1996), Some Like It Hot (1959), Killing Fields, The (1984), Silence of the Lambs, The (1991), Boot, Das (1981), Good Will Hunting (1997), Cinema Paradiso (1988), Meet John Doe (1941), Manchurian Candidate, The (1962), Bridge on the River Kwai, The (1957), Snow White and the Seven Dwarfs (1937), L.A. Confidential (1997), Titanic (1997), Sophie's Choice (1982), Raiders of the Lost Ark (1981), Empire Strikes Back, The (1980), Singin' in the Rain (1952), Apocalypse Now (1979), Citizen Kane (1941), Manhattan (1979)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |\n|243    |Secrets & Lies (1996), Platoon (1986), Remains of the Day, The (1993), Piano, The (1993), Amadeus (1984), Lawrence of Arabia (1962), Babe (1995), Breaking the Waves (1996), Manny & Lo (1996), In the Name of the Father (1993), Sophie's Choice (1982)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |\n|540    |Dead Man Walking (1995), Fargo (1996), Star Wars (1977), Boot, Das (1981)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |\n|85     |M*A*S*H (1970), Being There (1979), Wizard of Oz, The (1939), Sleeper (1973), Dr. Strangelove or: How I Learned to Stop Worrying and Love the Bomb (1963), Priest (1994), Strictly Ballroom (1992), Mary Poppins (1964), Shawshank Redemption, The (1994), Godfather, The (1972), Graduate, The (1967), My Fair Lady (1964), Annie Hall (1977), Harold and Maude (1971), Star Wars (1977), Vanya on 42nd Street (1994), Unforgiven (1992), Boot, Das (1981), Bridge on the River Kwai, The (1957), 2001: A Space Odyssey (1968), Lone Star (1996), Snow White and the Seven Dwarfs (1937), Singin' in the Rain (1952), Casablanca (1942), Citizen Kane (1941), Godfather: Part II, The (1974), Young Frankenstein (1974), Manhattan (1979)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |\n|251    |Alien (1979), Braveheart (1995), Wizard of Oz, The (1939), Psycho (1960), Shawshank Redemption, The (1994), Ransom (1996), Great Escape, The (1963), Star Wars (1977), Eat Drink Man Woman (1994), Austin Powers: International Man of Mystery (1997), Jerry Maguire (1996), North by Northwest (1959), Romy and Michele's High School Reunion (1997), Willy Wonka and the Chocolate Factory (1971), Lost Horizon (1937), Face/Off (1997), Fugitive, The (1993), Titanic (1997), Empire Strikes Back, The (1980), Die Hard (1988)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |\n|451    |Game, The (1997), Conspiracy Theory (1997), Edge, The (1997), Scream (1996), Volcano (1997), Event Horizon (1997), Liar Liar (1997), Picture Perfect (1997)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |\n|65     |Man Without a Face, The (1993), Fried Green Tomatoes (1991), 12 Angry Men (1957), Crucible, The (1996), Hoop Dreams (1994), Shawshank Redemption, The (1994), Mr. Holland's Opus (1995), Graduate, The (1967), Schindler's List (1993), Dead Man Walking (1995), E.T. the Extra-Terrestrial (1982), Dead Poets Society (1989), Searching for Bobby Fischer (1993), Dances with Wolves (1990), Sneakers (1992), Firm, The (1993), Star Wars (1977), Client, The (1994), To Kill a Mockingbird (1962), Miracle on 34th Street (1994), Field of Dreams (1989)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |\n|458    |Big Night (1996), Beauty and the Beast (1991), Looking for Richard (1996), Usual Suspects, The (1995), Chinatown (1974), Sleeper (1973), Sweet Hereafter, The (1997), Remains of the Day, The (1993), Wrong Trousers, The (1993), Emma (1996), Mother Night (1996), Amadeus (1984), Duck Soup (1933), Maltese Falcon, The (1941), Godfather, The (1972), Shine (1996), Dead Man Walking (1995), Annie Hall (1977), Nobody's Fool (1994), Amistad (1997), Donnie Brasco (1997), Hamlet (1996), Close Shave, A (1995), Ben-Hur (1959), Unforgiven (1992), Pulp Fiction (1994), Face/Off (1997), Quiz Show (1994), Postino, Il (1994), In the Name of the Father (1993), Fugitive, The (1993), Leaving Las Vegas (1995), L.A. Confidential (1997), Sense and Sensibility (1995), Bottle Rocket (1996), Casablanca (1942), Citizen Kane (1941), Godfather: Part II, The (1974)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |\n|883    |Big Night (1996), Shall We Dance? (1996), Natural Born Killers (1994), Murder at 1600 (1997), Third Man, The (1949), Double vie de V�ronique, La (Double Life of Veronique, The) (1991), M*A*S*H (1970), Hudsucker Proxy, The (1994), Alien (1979), Die xue shuang xiong (Killer, The) (1989), Secrets & Lies (1996), Koyaanisqatsi (1983), Clueless (1995), Treasure of the Sierra Madre, The (1948), Psycho (1960), Sphere (1998), Persuasion (1995), Before Sunrise (1995), Saint, The (1997), Wings of Desire (1987), Sweet Hereafter, The (1997), Unbearable Lightness of Being, The (1988), To Die For (1995), Monty Python and the Holy Grail (1974), Whole Wide World, The (1996), Wild Reeds (1994), Vertigo (1958), 8 1/2 (1963), Ran (1985), Strictly Ballroom (1992), Duck Soup (1933), Cats Don't Dance (1997), Men in Black (1997), Judgment Night (1993), Bonnie and Clyde (1967), Fearless (1993), As Good As It Gets (1997), Smoke (1995), Cool Hand Luke (1967), Three Colors: White (1994), Godfather, The (1972), Like Water For Chocolate (Como agua para chocolate) (1992), Brazil (1985), Age of Innocence, The (1993), Kundun (1997), Three Colors: Red (1994), Dead Man (1995), Thieves (Voleurs, Les) (1996), Twelve Monkeys (1995), Night on Earth (1991), Bound (1996), Batman (1989), Richard III (1995), Wild Bunch, The (1969), Eat Drink Man Woman (1994), Evita (1996), Close Shave, A (1995), Magic Hour, The (1998), Matilda (1996), Vanya on 42nd Street (1994), Dante's Peak (1997), Terminator, The (1984), When the Cats Away (Chacun cherche son chat) (1996), Safe (1995), Three Colors: Blue (1993), Willy Wonka and the Chocolate Factory (1971), Boot, Das (1981), Roman Holiday (1953), Pulp Fiction (1994), William Shakespeare's Romeo and Juliet (1996), Cold Comfort Farm (1995), Nikita (La Femme Nikita) (1990), My Favorite Season (1993), Rebel Without a Cause (1955), Leaving Las Vegas (1995), My Life as a Dog (Mitt liv som hund) (1985), Lone Star (1996), L.A. Confidential (1997), Private Parts (1997), Three Musketeers, The (1993), Fish Called Wanda, A (1988), Ruling Class, The (1972), M (1931), Citizen Kane (1941), Little City (1998), Blade Runner (1982)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |\n|588    |Courage Under Fire (1996), Ref, The (1994), Grease (1978), Gone with the Wind (1939), Dirty Dancing (1987), Apollo 13 (1995), Usual Suspects, The (1995), Parent Trap, The (1961), Nightmare Before Christmas, The (1993), Demolition Man (1993), Game, The (1997), Braveheart (1995), 101 Dalmatians (1996), Clueless (1995), Evening Star, The (1996), Wizard of Oz, The (1939), Monty Python and the Holy Grail (1974), Bedknobs and Broomsticks (1971), 12 Angry Men (1957), Abyss, The (1989), Ghost (1990), Reality Bites (1994), Interview with the Vampire (1994), Winnie the Pooh and the Blustery Day (1968), Chasing Amy (1997), Dazed and Confused (1993), Mary Poppins (1964), Wag the Dog (1997), Mr. Holland's Opus (1995), Ghost in the Shell (Kokaku kidotai) (1995), Dangerous Minds (1995), As Good As It Gets (1997), Sleepless in Seattle (1993), Moll Flanders (1996), Mallrats (1995), My Fair Lady (1964), Mirror Has Two Faces, The (1996), Bed of Roses (1996), In & Out (1997), Princess Bride, The (1987), Babe (1995), On Golden Pond (1981), Jaws (1975), Sneakers (1992), Santa Clause, The (1994), Pump Up the Volume (1990), Star Wars (1977), When Harry Met Sally... (1989), Jurassic Park (1993), Return of the Jedi (1983), Paris Is Burning (1990), Independence Day (ID4) (1996), Sound of Music, The (1965), Basketball Diaries, The (1995), Muppet Treasure Island (1996), With Honors (1994), Hunt for Red October, The (1990), Heathers (1989), Philadelphia (1993), Good Will Hunting (1997), Wedding Singer, The (1998), Mary Reilly (1996), William Shakespeare's Romeo and Juliet (1996), Back to the Future (1985), Much Ado About Nothing (1993), Crow, The (1994), Clerks (1994), Breakfast at Tiffany's (1961), Powder (1995), SubUrbia (1997), Snow White and the Seven Dwarfs (1937), Titanic (1997), Time to Kill, A (1996), Field of Dreams (1989), Home for the Holidays (1995), Empire Strikes Back, The (1980)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |\n|804    |It's a Wonderful Life (1946), Murder at 1600 (1997), Third Man, The (1949), Indiana Jones and the Last Crusade (1989), American Werewolf in London, An (1981), Being There (1979), Star Trek: First Contact (1996), Braveheart (1995), Supercop (1992), Good, The Bad and The Ugly, The (1966), Rear Window (1954), Toy Story (1995), Monty Python and the Holy Grail (1974), American President, The (1995), Ran (1985), Terminator 2: Judgment Day (1991), Mars Attacks! (1996), Men in Black (1997), Shawshank Redemption, The (1994), Jackie Chan's First Strike (1996), 39 Steps, The (1935), Cool Hand Luke (1967), Schindler's List (1993), African Queen, The (1951), Fargo (1996), Birds, The (1963), Magnificent Seven, The (1954), Jurassic Park (1993), Return of the Jedi (1983), Rumble in the Bronx (1995), North by Northwest (1959), Terminator, The (1984), Silence of the Lambs, The (1991), Boot, Das (1981), Nikita (La Femme Nikita) (1990), Bridge on the River Kwai, The (1957), Liar Liar (1997), One Flew Over the Cuckoo's Nest (1975), Army of Darkness (1993), Field of Dreams (1989), Raiders of the Lost Ark (1981), Casablanca (1942), Young Frankenstein (1974)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |\n|481    |M*A*S*H (1970), Henry V (1989), Butch Cassidy and the Sundance Kid (1969), Remains of the Day, The (1993), Emma (1996), Amadeus (1984), Arsenic and Old Lace (1944), Dial M for Murder (1954), African Queen, The (1951), Quiet Man, The (1952), Great Dictator, The (1940), When Harry Met Sally... (1989), Return of the Jedi (1983), Four Weddings and a Funeral (1994), Bridge on the River Kwai, The (1957), Fish Called Wanda, A (1988)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |\n|255    |Lost Highway (1997), Jaws (1975), Austin Powers: International Man of Mystery (1997), Happy Gilmore (1996), Nightmare on Elm Street, A (1984), Silence of the Lambs, The (1991), Pulp Fiction (1994), I Know What You Did Last Summer (1997)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |\n|472    |Hackers (1995), My Best Friend's Wedding (1997), Dragonheart (1996), Blues Brothers 2000 (1998), Showgirls (1995), Eraser (1996), Right Stuff, The (1983), Heavy Metal (1981), True Lies (1994), Indiana Jones and the Last Crusade (1989), Apollo 13 (1995), Alien (1979), Escape from L.A. (1996), Starship Troopers (1997), Lost in Space (1998), Usual Suspects, The (1995), Nightmare Before Christmas, The (1993), Demolition Man (1993), Star Trek: First Contact (1996), Braveheart (1995), Star Trek IV: The Voyage Home (1986), Clueless (1995), Wizard of Oz, The (1939), Psycho (1960), Benny & Joon (1993), Addams Family Values (1993), Fried Green Tomatoes (1991), Saint, The (1997), Rear Window (1954), Toy Story (1995), Casper (1995), Screamers (1995), Monty Python and the Holy Grail (1974), Four Rooms (1995), Highlander (1986), Home Alone (1990), Fifth Element, The (1997), Ghost (1990), Fantasia (1940), Reality Bites (1994), Striptease (1996), Interview with the Vampire (1994), Terminator 2: Judgment Day (1991), Mars Attacks! (1996), Amadeus (1984), Contact (1997), Star Trek VI: The Undiscovered Country (1991), Shawshank Redemption, The (1994), Waterworld (1995), Spawn (1997), Some Kind of Wonderful (1987), Schindler's List (1993), Groundhog Day (1993), Batman Returns (1992), Species (1995), Father of the Bride (1950), Mask, The (1994), Real Genius (1985), Brazil (1985), E.T. the Extra-Terrestrial (1982), Pretty Woman (1990), Speed (1994), Ransom (1996), Bram Stoker's Dracula (1992), Star Trek III: The Search for Spock (1984), Shadow, The (1994), Princess Bride, The (1987), Star Trek: The Motion Picture (1979), Chain Reaction (1996), Fargo (1996), Top Gun (1986), I.Q. (1994), Aliens (1986), Star Trek: Generations (1994), Rob Roy (1995), Twelve Monkeys (1995), First Knight (1995), Alien: Resurrection (1997), Legends of the Fall (1994), Forrest Gump (1994), Little Rascals, The (1994), Sneakers (1992), Batman (1989), Pump Up the Volume (1990), Star Wars (1977), Tank Girl (1995), Jurassic Park (1993), Return of the Jedi (1983), Scream (1996), Cliffhanger (1993), Rumble in the Bronx (1995), Stargate (1994), Independence Day (ID4) (1996), Phenomenon (1996), Matilda (1996), Batman Forever (1995), Die Hard 2 (1990), Die Hard: With a Vengeance (1995), Michael (1996), Cutthroat Island (1995), Terminator, The (1984), So I Married an Axe Murderer (1993), Tomorrow Never Dies (1997), Pulp Fiction (1994), Star Trek: The Wrath of Khan (1982), Stand by Me (1986), William Shakespeare's Romeo and Juliet (1996), Seven (Se7en) (1995), Desperado (1995), Back to the Future (1985), Mortal Kombat (1995), Arrival, The (1996), Crow, The (1994), Mary Shelley's Frankenstein (1994), GoldenEye (1995), Fugitive, The (1993), Sliver (1993), Titanic (1997), While You Were Sleeping (1995), Mission: Impossible (1996), Blues Brothers, The (1980), Raiders of the Lost Ark (1981), Quick and the Dead, The (1995), Empire Strikes Back, The (1980), Trainspotting (1996), Young Frankenstein (1974)|\n|296    |Shall We Dance? (1996), Orlando (1993), Being There (1979), Star Trek: First Contact (1996), Secrets & Lies (1996), Diva (1981), Chinatown (1974), Butch Cassidy and the Sundance Kid (1969), Toy Story (1995), Angels and Insects (1995), Day the Earth Stood Still, The (1951), Rosewood (1997), Raise the Red Lantern (1991), A Chef in Love (1996), Terminator 2: Judgment Day (1991), Hoop Dreams (1994), Amadeus (1984), Contact (1997), Antonia's Line (1995), Men in Black (1997), Bonnie and Clyde (1967), That Thing You Do! (1996), Full Monty, The (1997), Shallow Grave (1994), Arsenic and Old Lace (1944), Godfather, The (1972), English Patient, The (1996), African Queen, The (1951), When We Were Kings (1996), My Fair Lady (1964), In & Out (1997), Wallace & Gromit: The Best of Aardman Animation (1996), Professional, The (1994), Fargo (1996), Taxi Driver (1976), Twelve Monkeys (1995), Annie Hall (1977), Sting, The (1973), Restoration (1995), Amistad (1997), Star Wars (1977), Donnie Brasco (1997), Eat Drink Man Woman (1994), Magnificent Seven, The (1954), Return of the Jedi (1983), To Kill a Mockingbird (1962), Jerry Maguire (1996), Independence Day (ID4) (1996), Phenomenon (1996), North by Northwest (1959), Some Like It Hot (1959), Killing Fields, The (1984), When the Cats Away (Chacun cherche son chat) (1996), Silence of the Lambs, The (1991), Short Cuts (1993), Breaking the Waves (1996), Boot, Das (1981), Good Will Hunting (1997), Pulp Fiction (1994), Seven (Se7en) (1995), Back to the Future (1985), Much Ado About Nothing (1993), People vs. Larry Flynt, The (1996), Nikita (La Femme Nikita) (1990), Bridge on the River Kwai, The (1957), Grosse Pointe Blank (1997), Leaving Las Vegas (1995), One Flew Over the Cuckoo's Nest (1975), Lone Star (1996), Titanic (1997), Sleepers (1996), Sophie's Choice (1982), Empire Strikes Back, The (1980), Singin' in the Rain (1952), Apocalypse Now (1979), Casablanca (1942), Citizen Kane (1941), Some Folks Call It a Sling Blade (1993), Apt Pupil (1998), Godfather: Part II, The (1974), Blade Runner (1982)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |\n+-------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\nonly showing top 20 rows\n\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1750495393412_-1527523085","id":"20250621-084313_1826862279","dateCreated":"2025-06-21T08:43:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3617","text":"%pyspark\r\n\r\nfrom pyspark.sql.functions import collect_list, concat_ws\r\n\r\n\r\nuser_counts = ratingsDF.groupBy(\"user_id\").count().filter(\"count >= 50\")\r\n\r\n# high ratings\r\nrat = ratingsDF.filter(\"rating == 5\")\r\n\r\n# join together\r\njoined = rat.join(user_counts, \"user_id\") \\\r\n                     .join(titlesDF, \"movie_id\")\r\n\r\n# collapse title column into one row per user\r\nrrr = joined.groupBy(\"user_id\") \\\r\n    .agg(concat_ws(\", \", collect_list(\"title\")).alias(\"favourite_movies\"))\r\n\r\nrrr.show(truncate=False)","dateUpdated":"2025-06-21T10:01:17+0000","dateFinished":"2025-06-21T09:59:44+0000","dateStarted":"2025-06-21T09:59:18+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n|user_id|favourite_movies                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |\n+-------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n|148    |Gone with the Wind (1939), Hunchback of Notre Dame, The (1996), Being There (1979), This Is Spinal Tap (1984), James and the Giant Peach (1996), Dr. Strangelove or: How I Learned to Stop Worrying and Love the Bomb (1963), Monty Python and the Holy Grail (1974), Wrong Trousers, The (1993), Fantasia (1940), Streetcar Named Desire, A (1951), Wallace & Gromit: The Best of Aardman Animation (1996), Princess Bride, The (1987), Twelve Monkeys (1995), Sting, The (1973), Forrest Gump (1994), My Left Foot (1989), Star Wars (1977), Return of the Jedi (1983), Four Weddings and a Funeral (1994), Close Shave, A (1995), Pink Floyd - The Wall (1982), Pulp Fiction (1994), Walkabout (1971), Lion King, The (1994), Cold Comfort Farm (1995), 2001: A Space Odyssey (1968), My Life as a Dog (Mitt liv som hund) (1985), One Flew Over the Cuckoo's Nest (1975), Raiders of the Lost Ark (1981), Empire Strikes Back, The (1980), Blade Runner (1982)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |\n|496    |Gone with the Wind (1939), Immortal Beloved (1994), Henry V (1989), Prophecy, The (1995), Interview with the Vampire (1994), Amadeus (1984), Mallrats (1995), Bram Stoker's Dracula (1992), Princess Bride, The (1987), Strange Days (1995), Searching for Bobby Fischer (1993), Restoration (1995), Kama Sutra: A Tale of Love (1996), Richard III (1995), Star Wars (1977), Return of the Jedi (1983), Farewell My Concubine (1993), Pulp Fiction (1994), Mary Shelley's Frankenstein (1994), Clerks (1994), Rosencrantz and Guildenstern Are Dead (1990), Empire Strikes Back, The (1980), Blade Runner (1982)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |\n|833    |Alien (1979), Die xue shuang xiong (Killer, The) (1989), Raging Bull (1980), Starship Troopers (1997), Usual Suspects, The (1995), This Is Spinal Tap (1984), Jackie Brown (1997), Chinatown (1974), Ed Wood (1994), Good, The Bad and The Ugly, The (1966), Bride of Frankenstein (1935), Psycho (1960), GoodFellas (1990), Dr. Strangelove or: How I Learned to Stop Worrying and Love the Bomb (1963), Monty Python and the Holy Grail (1974), Boogie Nights (1997), Raise the Red Lantern (1991), Once Upon a Time in the West (1969), Terminator 2: Judgment Day (1991), Monty Python's Life of Brian (1979), Carrie (1976), Clockwork Orange, A (1971), Godfather, The (1972), Romper Stomper (1992), Taxi Driver (1976), Wild Bunch, The (1969), Glengarry Glen Ross (1992), Terminator, The (1984), Crumb (1994), Unforgiven (1992), Sunset Blvd. (1950), Face/Off (1997), Seven (Se7en) (1995), People vs. Larry Flynt, The (1996), Living in Oblivion (1995), Switchblade Sisters (1975), Night of the Living Dead (1968), Apocalypse Now (1979), Citizen Kane (1941), Godfather: Part II, The (1974), Blade Runner (1982)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |\n|463    |Pillow Book, The (1995), Eve's Bayou (1997), Angels and Insects (1995), Emma (1996), Contact (1997), Antonia's Line (1995), Full Monty, The (1997), Godfather, The (1972), In & Out (1997), Breaking the Waves (1996), Cold Comfort Farm (1995), Lone Star (1996), L.A. Confidential (1997), Sense and Sensibility (1995)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |\n|897    |It's a Wonderful Life (1946), Dragonheart (1996), Christmas Carol, A (1938), Cape Fear (1962), Eraser (1996), M*A*S*H (1970), Indiana Jones and the Last Crusade (1989), Alien (1979), Dumbo (1941), Braveheart (1995), Young Guns (1988), Good, The Bad and The Ugly, The (1966), Old Yeller (1957), Wizard of Oz, The (1939), Psycho (1960), Rear Window (1954), Toy Story (1995), Screamers (1995), Unforgettable (1996), Day the Earth Stood Still, The (1951), Ghost (1990), Once Upon a Time in the West (1969), Terminator 2: Judgment Day (1991), Arsenic and Old Lace (1944), Cool Hand Luke (1967), Godfather, The (1972), Father of the Bride (1950), E.T. the Extra-Terrestrial (1982), African Queen, The (1951), Speed (1994), Top Gun (1986), Conan the Barbarian (1981), Aliens (1986), Mr. Smith Goes to Washington (1939), Birds, The (1963), Sting, The (1973), Jungle Book, The (1994), Craft, The (1996), Forrest Gump (1994), Dances with Wolves (1990), Jaws (1975), Star Wars (1977), Jurassic Park (1993), Scream (1996), Independence Day (ID4) (1996), Sound of Music, The (1965), Nutty Professor, The (1996), Ben-Hur (1959), Pink Floyd - The Wall (1982), Michael (1996), Terminator, The (1984), Silence of the Lambs, The (1991), Willy Wonka and the Chocolate Factory (1971), Shining, The (1980), Miracle on 34th Street (1994), Full Metal Jacket (1987), Desperado (1995), Crow, The (1994), Lion King, The (1994), Fugitive, The (1993), Evil Dead II (1987), Twister (1996), Snow White and the Seven Dwarfs (1937), Mission: Impossible (1996), Blues Brothers, The (1980), Night of the Living Dead (1968), Raiders of the Lost Ark (1981), Apocalypse Now (1979), Deer Hunter, The (1978), Godfather: Part II, The (1974), Young Frankenstein (1974)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |\n|392    |Third Man, The (1949), Mother (1996), This Is Spinal Tap (1984), It Happened One Night (1934), Everyone Says I Love You (1996), Chasing Amy (1997), 12 Angry Men (1957), Boogie Nights (1997), Adventures of Robin Hood, The (1938), Seventh Seal, The (Sjunde inseglet, Det) (1957), Amadeus (1984), Chasing Amy (1997), Men in Black (1997), Lawrence of Arabia (1962), Full Monty, The (1997), 39 Steps, The (1935), Jean de Florette (1986), Clockwork Orange, A (1971), As Good As It Gets (1997), Godfather, The (1972), Graduate, The (1967), When We Were Kings (1996), Babe (1995), Taxi Driver (1976), Manon of the Spring (Manon des sources) (1986), Waiting for Guffman (1996), Star Wars (1977), Return of the Jedi (1983), Evita (1996), Some Like It Hot (1959), Killing Fields, The (1984), Silence of the Lambs, The (1991), Boot, Das (1981), Good Will Hunting (1997), Cinema Paradiso (1988), Meet John Doe (1941), Manchurian Candidate, The (1962), Bridge on the River Kwai, The (1957), Snow White and the Seven Dwarfs (1937), L.A. Confidential (1997), Titanic (1997), Sophie's Choice (1982), Raiders of the Lost Ark (1981), Empire Strikes Back, The (1980), Singin' in the Rain (1952), Apocalypse Now (1979), Citizen Kane (1941), Manhattan (1979)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |\n|243    |Secrets & Lies (1996), Platoon (1986), Remains of the Day, The (1993), Piano, The (1993), Amadeus (1984), Lawrence of Arabia (1962), Babe (1995), Breaking the Waves (1996), Manny & Lo (1996), In the Name of the Father (1993), Sophie's Choice (1982)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |\n|540    |Dead Man Walking (1995), Fargo (1996), Star Wars (1977), Boot, Das (1981)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |\n|85     |M*A*S*H (1970), Being There (1979), Wizard of Oz, The (1939), Sleeper (1973), Dr. Strangelove or: How I Learned to Stop Worrying and Love the Bomb (1963), Priest (1994), Strictly Ballroom (1992), Mary Poppins (1964), Shawshank Redemption, The (1994), Godfather, The (1972), Graduate, The (1967), My Fair Lady (1964), Annie Hall (1977), Harold and Maude (1971), Star Wars (1977), Vanya on 42nd Street (1994), Unforgiven (1992), Boot, Das (1981), Bridge on the River Kwai, The (1957), 2001: A Space Odyssey (1968), Lone Star (1996), Snow White and the Seven Dwarfs (1937), Singin' in the Rain (1952), Casablanca (1942), Citizen Kane (1941), Godfather: Part II, The (1974), Young Frankenstein (1974), Manhattan (1979)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |\n|251    |Alien (1979), Braveheart (1995), Wizard of Oz, The (1939), Psycho (1960), Shawshank Redemption, The (1994), Ransom (1996), Great Escape, The (1963), Star Wars (1977), Eat Drink Man Woman (1994), Austin Powers: International Man of Mystery (1997), Jerry Maguire (1996), North by Northwest (1959), Romy and Michele's High School Reunion (1997), Willy Wonka and the Chocolate Factory (1971), Lost Horizon (1937), Face/Off (1997), Fugitive, The (1993), Titanic (1997), Empire Strikes Back, The (1980), Die Hard (1988)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |\n|451    |Game, The (1997), Conspiracy Theory (1997), Edge, The (1997), Scream (1996), Volcano (1997), Event Horizon (1997), Liar Liar (1997), Picture Perfect (1997)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |\n|65     |Man Without a Face, The (1993), Fried Green Tomatoes (1991), 12 Angry Men (1957), Crucible, The (1996), Hoop Dreams (1994), Shawshank Redemption, The (1994), Mr. Holland's Opus (1995), Graduate, The (1967), Schindler's List (1993), Dead Man Walking (1995), E.T. the Extra-Terrestrial (1982), Dead Poets Society (1989), Searching for Bobby Fischer (1993), Dances with Wolves (1990), Sneakers (1992), Firm, The (1993), Star Wars (1977), Client, The (1994), To Kill a Mockingbird (1962), Miracle on 34th Street (1994), Field of Dreams (1989)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |\n|458    |Big Night (1996), Beauty and the Beast (1991), Looking for Richard (1996), Usual Suspects, The (1995), Chinatown (1974), Sleeper (1973), Sweet Hereafter, The (1997), Remains of the Day, The (1993), Wrong Trousers, The (1993), Emma (1996), Mother Night (1996), Amadeus (1984), Duck Soup (1933), Maltese Falcon, The (1941), Godfather, The (1972), Shine (1996), Dead Man Walking (1995), Annie Hall (1977), Nobody's Fool (1994), Amistad (1997), Donnie Brasco (1997), Hamlet (1996), Close Shave, A (1995), Ben-Hur (1959), Unforgiven (1992), Pulp Fiction (1994), Face/Off (1997), Quiz Show (1994), Postino, Il (1994), In the Name of the Father (1993), Fugitive, The (1993), Leaving Las Vegas (1995), L.A. Confidential (1997), Sense and Sensibility (1995), Bottle Rocket (1996), Casablanca (1942), Citizen Kane (1941), Godfather: Part II, The (1974)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |\n|883    |Big Night (1996), Shall We Dance? (1996), Natural Born Killers (1994), Murder at 1600 (1997), Third Man, The (1949), Double vie de V�ronique, La (Double Life of Veronique, The) (1991), M*A*S*H (1970), Hudsucker Proxy, The (1994), Alien (1979), Die xue shuang xiong (Killer, The) (1989), Secrets & Lies (1996), Koyaanisqatsi (1983), Clueless (1995), Treasure of the Sierra Madre, The (1948), Psycho (1960), Sphere (1998), Persuasion (1995), Before Sunrise (1995), Saint, The (1997), Wings of Desire (1987), Sweet Hereafter, The (1997), Unbearable Lightness of Being, The (1988), To Die For (1995), Monty Python and the Holy Grail (1974), Whole Wide World, The (1996), Wild Reeds (1994), Vertigo (1958), 8 1/2 (1963), Ran (1985), Strictly Ballroom (1992), Duck Soup (1933), Cats Don't Dance (1997), Men in Black (1997), Judgment Night (1993), Bonnie and Clyde (1967), Fearless (1993), As Good As It Gets (1997), Smoke (1995), Cool Hand Luke (1967), Three Colors: White (1994), Godfather, The (1972), Like Water For Chocolate (Como agua para chocolate) (1992), Brazil (1985), Age of Innocence, The (1993), Kundun (1997), Three Colors: Red (1994), Dead Man (1995), Thieves (Voleurs, Les) (1996), Twelve Monkeys (1995), Night on Earth (1991), Bound (1996), Batman (1989), Richard III (1995), Wild Bunch, The (1969), Eat Drink Man Woman (1994), Evita (1996), Close Shave, A (1995), Magic Hour, The (1998), Matilda (1996), Vanya on 42nd Street (1994), Dante's Peak (1997), Terminator, The (1984), When the Cats Away (Chacun cherche son chat) (1996), Safe (1995), Three Colors: Blue (1993), Willy Wonka and the Chocolate Factory (1971), Boot, Das (1981), Roman Holiday (1953), Pulp Fiction (1994), William Shakespeare's Romeo and Juliet (1996), Cold Comfort Farm (1995), Nikita (La Femme Nikita) (1990), My Favorite Season (1993), Rebel Without a Cause (1955), Leaving Las Vegas (1995), My Life as a Dog (Mitt liv som hund) (1985), Lone Star (1996), L.A. Confidential (1997), Private Parts (1997), Three Musketeers, The (1993), Fish Called Wanda, A (1988), Ruling Class, The (1972), M (1931), Citizen Kane (1941), Little City (1998), Blade Runner (1982)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |\n|588    |Courage Under Fire (1996), Ref, The (1994), Grease (1978), Gone with the Wind (1939), Dirty Dancing (1987), Apollo 13 (1995), Usual Suspects, The (1995), Parent Trap, The (1961), Nightmare Before Christmas, The (1993), Demolition Man (1993), Game, The (1997), Braveheart (1995), 101 Dalmatians (1996), Clueless (1995), Evening Star, The (1996), Wizard of Oz, The (1939), Monty Python and the Holy Grail (1974), Bedknobs and Broomsticks (1971), 12 Angry Men (1957), Abyss, The (1989), Ghost (1990), Reality Bites (1994), Interview with the Vampire (1994), Winnie the Pooh and the Blustery Day (1968), Chasing Amy (1997), Dazed and Confused (1993), Mary Poppins (1964), Wag the Dog (1997), Mr. Holland's Opus (1995), Ghost in the Shell (Kokaku kidotai) (1995), Dangerous Minds (1995), As Good As It Gets (1997), Sleepless in Seattle (1993), Moll Flanders (1996), Mallrats (1995), My Fair Lady (1964), Mirror Has Two Faces, The (1996), Bed of Roses (1996), In & Out (1997), Princess Bride, The (1987), Babe (1995), On Golden Pond (1981), Jaws (1975), Sneakers (1992), Santa Clause, The (1994), Pump Up the Volume (1990), Star Wars (1977), When Harry Met Sally... (1989), Jurassic Park (1993), Return of the Jedi (1983), Paris Is Burning (1990), Independence Day (ID4) (1996), Sound of Music, The (1965), Basketball Diaries, The (1995), Muppet Treasure Island (1996), With Honors (1994), Hunt for Red October, The (1990), Heathers (1989), Philadelphia (1993), Good Will Hunting (1997), Wedding Singer, The (1998), Mary Reilly (1996), William Shakespeare's Romeo and Juliet (1996), Back to the Future (1985), Much Ado About Nothing (1993), Crow, The (1994), Clerks (1994), Breakfast at Tiffany's (1961), Powder (1995), SubUrbia (1997), Snow White and the Seven Dwarfs (1937), Titanic (1997), Time to Kill, A (1996), Field of Dreams (1989), Home for the Holidays (1995), Empire Strikes Back, The (1980)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |\n|804    |It's a Wonderful Life (1946), Murder at 1600 (1997), Third Man, The (1949), Indiana Jones and the Last Crusade (1989), American Werewolf in London, An (1981), Being There (1979), Star Trek: First Contact (1996), Braveheart (1995), Supercop (1992), Good, The Bad and The Ugly, The (1966), Rear Window (1954), Toy Story (1995), Monty Python and the Holy Grail (1974), American President, The (1995), Ran (1985), Terminator 2: Judgment Day (1991), Mars Attacks! (1996), Men in Black (1997), Shawshank Redemption, The (1994), Jackie Chan's First Strike (1996), 39 Steps, The (1935), Cool Hand Luke (1967), Schindler's List (1993), African Queen, The (1951), Fargo (1996), Birds, The (1963), Magnificent Seven, The (1954), Jurassic Park (1993), Return of the Jedi (1983), Rumble in the Bronx (1995), North by Northwest (1959), Terminator, The (1984), Silence of the Lambs, The (1991), Boot, Das (1981), Nikita (La Femme Nikita) (1990), Bridge on the River Kwai, The (1957), Liar Liar (1997), One Flew Over the Cuckoo's Nest (1975), Army of Darkness (1993), Field of Dreams (1989), Raiders of the Lost Ark (1981), Casablanca (1942), Young Frankenstein (1974)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |\n|481    |M*A*S*H (1970), Henry V (1989), Butch Cassidy and the Sundance Kid (1969), Remains of the Day, The (1993), Emma (1996), Amadeus (1984), Arsenic and Old Lace (1944), Dial M for Murder (1954), African Queen, The (1951), Quiet Man, The (1952), Great Dictator, The (1940), When Harry Met Sally... (1989), Return of the Jedi (1983), Four Weddings and a Funeral (1994), Bridge on the River Kwai, The (1957), Fish Called Wanda, A (1988)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |\n|255    |Lost Highway (1997), Jaws (1975), Austin Powers: International Man of Mystery (1997), Happy Gilmore (1996), Nightmare on Elm Street, A (1984), Silence of the Lambs, The (1991), Pulp Fiction (1994), I Know What You Did Last Summer (1997)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |\n|472    |Hackers (1995), My Best Friend's Wedding (1997), Dragonheart (1996), Blues Brothers 2000 (1998), Showgirls (1995), Eraser (1996), Right Stuff, The (1983), Heavy Metal (1981), True Lies (1994), Indiana Jones and the Last Crusade (1989), Apollo 13 (1995), Alien (1979), Escape from L.A. (1996), Starship Troopers (1997), Lost in Space (1998), Usual Suspects, The (1995), Nightmare Before Christmas, The (1993), Demolition Man (1993), Star Trek: First Contact (1996), Braveheart (1995), Star Trek IV: The Voyage Home (1986), Clueless (1995), Wizard of Oz, The (1939), Psycho (1960), Benny & Joon (1993), Addams Family Values (1993), Fried Green Tomatoes (1991), Saint, The (1997), Rear Window (1954), Toy Story (1995), Casper (1995), Screamers (1995), Monty Python and the Holy Grail (1974), Four Rooms (1995), Highlander (1986), Home Alone (1990), Fifth Element, The (1997), Ghost (1990), Fantasia (1940), Reality Bites (1994), Striptease (1996), Interview with the Vampire (1994), Terminator 2: Judgment Day (1991), Mars Attacks! (1996), Amadeus (1984), Contact (1997), Star Trek VI: The Undiscovered Country (1991), Shawshank Redemption, The (1994), Waterworld (1995), Spawn (1997), Some Kind of Wonderful (1987), Schindler's List (1993), Groundhog Day (1993), Batman Returns (1992), Species (1995), Father of the Bride (1950), Mask, The (1994), Real Genius (1985), Brazil (1985), E.T. the Extra-Terrestrial (1982), Pretty Woman (1990), Speed (1994), Ransom (1996), Bram Stoker's Dracula (1992), Star Trek III: The Search for Spock (1984), Shadow, The (1994), Princess Bride, The (1987), Star Trek: The Motion Picture (1979), Chain Reaction (1996), Fargo (1996), Top Gun (1986), I.Q. (1994), Aliens (1986), Star Trek: Generations (1994), Rob Roy (1995), Twelve Monkeys (1995), First Knight (1995), Alien: Resurrection (1997), Legends of the Fall (1994), Forrest Gump (1994), Little Rascals, The (1994), Sneakers (1992), Batman (1989), Pump Up the Volume (1990), Star Wars (1977), Tank Girl (1995), Jurassic Park (1993), Return of the Jedi (1983), Scream (1996), Cliffhanger (1993), Rumble in the Bronx (1995), Stargate (1994), Independence Day (ID4) (1996), Phenomenon (1996), Matilda (1996), Batman Forever (1995), Die Hard 2 (1990), Die Hard: With a Vengeance (1995), Michael (1996), Cutthroat Island (1995), Terminator, The (1984), So I Married an Axe Murderer (1993), Tomorrow Never Dies (1997), Pulp Fiction (1994), Star Trek: The Wrath of Khan (1982), Stand by Me (1986), William Shakespeare's Romeo and Juliet (1996), Seven (Se7en) (1995), Desperado (1995), Back to the Future (1985), Mortal Kombat (1995), Arrival, The (1996), Crow, The (1994), Mary Shelley's Frankenstein (1994), GoldenEye (1995), Fugitive, The (1993), Sliver (1993), Titanic (1997), While You Were Sleeping (1995), Mission: Impossible (1996), Blues Brothers, The (1980), Raiders of the Lost Ark (1981), Quick and the Dead, The (1995), Empire Strikes Back, The (1980), Trainspotting (1996), Young Frankenstein (1974)|\n|296    |Shall We Dance? (1996), Orlando (1993), Being There (1979), Star Trek: First Contact (1996), Secrets & Lies (1996), Diva (1981), Chinatown (1974), Butch Cassidy and the Sundance Kid (1969), Toy Story (1995), Angels and Insects (1995), Day the Earth Stood Still, The (1951), Rosewood (1997), Raise the Red Lantern (1991), A Chef in Love (1996), Terminator 2: Judgment Day (1991), Hoop Dreams (1994), Amadeus (1984), Contact (1997), Antonia's Line (1995), Men in Black (1997), Bonnie and Clyde (1967), That Thing You Do! (1996), Full Monty, The (1997), Shallow Grave (1994), Arsenic and Old Lace (1944), Godfather, The (1972), English Patient, The (1996), African Queen, The (1951), When We Were Kings (1996), My Fair Lady (1964), In & Out (1997), Wallace & Gromit: The Best of Aardman Animation (1996), Professional, The (1994), Fargo (1996), Taxi Driver (1976), Twelve Monkeys (1995), Annie Hall (1977), Sting, The (1973), Restoration (1995), Amistad (1997), Star Wars (1977), Donnie Brasco (1997), Eat Drink Man Woman (1994), Magnificent Seven, The (1954), Return of the Jedi (1983), To Kill a Mockingbird (1962), Jerry Maguire (1996), Independence Day (ID4) (1996), Phenomenon (1996), North by Northwest (1959), Some Like It Hot (1959), Killing Fields, The (1984), When the Cats Away (Chacun cherche son chat) (1996), Silence of the Lambs, The (1991), Short Cuts (1993), Breaking the Waves (1996), Boot, Das (1981), Good Will Hunting (1997), Pulp Fiction (1994), Seven (Se7en) (1995), Back to the Future (1985), Much Ado About Nothing (1993), People vs. Larry Flynt, The (1996), Nikita (La Femme Nikita) (1990), Bridge on the River Kwai, The (1957), Grosse Pointe Blank (1997), Leaving Las Vegas (1995), One Flew Over the Cuckoo's Nest (1975), Lone Star (1996), Titanic (1997), Sleepers (1996), Sophie's Choice (1982), Empire Strikes Back, The (1980), Singin' in the Rain (1952), Apocalypse Now (1979), Casablanca (1942), Citizen Kane (1941), Some Folks Call It a Sling Blade (1993), Apt Pupil (1998), Godfather: Part II, The (1974), Blade Runner (1982)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |\n+-------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\nonly showing top 20 rows\n\n"}]}},{"text":"%md\nGoing on on just the five-star ratings of users with at least 50 reviews, user 463 loves drama with some Jane Austen romance movies. User 540 loves crime (Fargo and Dead Man Walking). User 451 loves thriller movies.\n","user":"anonymous","dateUpdated":"2025-06-21T10:08:07+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1750499801908_507310915","id":"20250621-095641_1509042664","dateCreated":"2025-06-21T09:56:41+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4330"},{"text":"%pyspark\nuser540 = ratingsDF.filter(ratingsDF.user_id == 540)\njoined540 = user540.join(titlesDF, \"movie_id\")\njoined540.show()\n","user":"anonymous","dateUpdated":"2025-06-21T10:06:37+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1750500250749_-1625127833","id":"20250621-100410_29427415","dateCreated":"2025-06-21T10:04:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4483","dateFinished":"2025-06-21T10:06:39+0000","dateStarted":"2025-06-21T10:06:37+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+-------+------+--------------------+\n|movie_id|user_id|rating|               title|\n+--------+-------+------+--------------------+\n|     471|    540|   4.0|Courage Under Fir...|\n|    1016|    540|   4.0|      Con Air (1997)|\n|     597|    540|   4.0|       Eraser (1996)|\n|     126|    540|   3.0|Spitfire Grill, T...|\n|    1226|    540|   4.0|Night Falls on Ma...|\n|     596|    540|   4.0|Hunchback of Notr...|\n|     762|    540|   4.0|Beautiful Girls (...|\n|     300|    540|   3.0|Air Force One (1997)|\n|     332|    540|   4.0|Kiss the Girls (1...|\n|     333|    540|   4.0|    Game, The (1997)|\n|     222|    540|   4.0|Star Trek: First ...|\n|     111|    540|   4.0|Truth About Cats ...|\n|     473|    540|   3.0|James and the Gia...|\n|       1|    540|   3.0|    Toy Story (1995)|\n|     274|    540|   4.0|      Sabrina (1995)|\n|      13|    540|   4.0|Mighty Aphrodite ...|\n|     280|    540|   3.0|Up Close and Pers...|\n|      20|    540|   4.0|Angels and Insect...|\n|     340|    540|   4.0|Boogie Nights (1997)|\n|     250|    540|   4.0|Fifth Element, Th...|\n+--------+-------+------+--------------------+\nonly showing top 20 rows\n\n"}]}},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2025-06-21T10:04:30+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1750500270820_471799645","id":"20250621-100430_663331890","dateCreated":"2025-06-21T10:04:30+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4539"}],"name":"ass3","id":"2KX5NUDCD","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}